{"version":3,"sources":["webpack:///./src/views/front/Product.vue","webpack:///./src/views/front/Product.vue?41a9"],"names":["class","style","id","enterImage","firstImage","product","imagesUrl","img","key","role","to","category","title","description","price","origin_price","$cash","unit","type","min","max","maxNum","qty","inputmode","disabled","isDisabled","is_max","tempNum","blurInput","addToCart","spin-item","filterDatas","length","goToProduct","prev_product","next_product","content","datas","is-disabled","emits","props","components","FrontSwiper","data","products","methods","getProduct","api","this","then","res","success","$pushMessage","$router","push","document","filterProducts","getSiblingProduct","getMaxNum","setTimeout","$emitter","emit","catch","err","getAllProducts","reverse","arrFilter","filter","item","maxSize","arrSet","Set","i","size","num","Math","floor","random","add","forEach","idx","prev","next","inCart","carts","product_id","watch","$route","handler","val","name","params","deep","newItem","mounted","__exports__","render"],"mappings":"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","file":"js/chunk-2d0cfb23.f0b1726b.js","sourcesContent":["<template>\n  <div class=\"container-fluid\">\n    <div class=\"product container row g-0 px-md-3 mx-auto\">\n      <div class=\"product-photos col-md-6 row g-0 align-self-start p-3 p-md-0\">\n        <div class=\"photo-lg col-12\">\n          <span :style=\"{ 'background-image': `url(${enterImage == '' ? firstImage :\n          enterImage})` }\"></span>\n        </div>\n        <div\n          class=\"photo-sm col-4\"\n          role=\"button\"\n          v-for=\"(img, key) in product.imagesUrl\"\n          :key=\"key\"\n          :class=\"img === enterImage ? 'active' : ''\"\n          @mouseover=\"enterImage = img\"\n          @click=\"enterImage = img\"\n        >\n          <span :style=\"{ 'background-image': `url(${img})` }\"></span>\n        </div>\n      </div>\n      <div\n        class=\"product-content col-md-6 text-center text-md-start\">\n        <span class=\"path d-block mb-4 fs-7\">\n          <router-link to=\"/\">首頁</router-link>\n          &nbsp;/&nbsp;\n          <router-link to=\"/products?category=all&page=1\">New Collection</router-link>\n          &nbsp;/&nbsp;\n          <span class=\"active\">{{ product.category }}</span>\n        </span>\n        <h1>{{ product.title }}</h1>\n        <p class=\"product-desc\">商品資訊：{{ product.description }}</p>\n        <!-- <p class=\"text-secondary m-0\" v-if=\"product.content\">\n          {{ product.content }}\n        </p> -->\n        <p class=\"product-price mt-4\" v-if=\"product.price\">\n          <span v-if=\"product.price < product.origin_price\"\n            >${{ $cash(product.price) }}</span\n          >\n          <small :class=\"product.price < product.origin_price ? 'del' : ''\"\n            >$ {{ $cash(product.origin_price) }} NTD</small\n          >\n          <small class=\"fs-7 ms-2 text-secondary\">/ {{ product.unit }}</small>\n        </p>\n        <div class=\"product-btns col-md-9 d-md-flex\">\n          <input\n            type=\"number\"\n            min=\"1\"\n            :max=\"maxNum\"\n            class=\"form-control nature-input text-center text-md-start\"\n            v-model.number=\"product.qty\"\n            inputmode=\"numeric\"\n            :disabled=\"isDisabled === product.id || product.is_max\"\n            @focus=\"tempNum = product\"\n            @blur=\"blurInput\"\n          />\n          <button\n            class=\"btn btn-primary col-12 col-md-7 ms-md-2 p-3 mt-3 mt-md-0\"\n            type=\"button\"\n            :disabled=\"isDisabled === product.id || product.is_max\"\n            @click=\"addToCart(product)\"\n          >\n            加入購物車\n            <Spinner :spin-item=\"product.id\" />\n          </button>\n        </div>\n        <small class=\"d-block text-danger mt-1\" v-if=\"product.is_max\">已達可購買最大數量</small>\n      </div>\n      <div\n        class=\"product-page row g-0 justify-content-between py-4 px-3 px-md-0\"\n        v-if=\"filterDatas.length > 0\"\n      >\n        <button\n          class=\"col-6 col-md-2 btn btn-outline-secondary fs-7\"\n          type=\"button\"\n          @click=\"goToProduct(prev_product)\"\n        ><i class=\"material-icons fs-6\">west</i>{{ prev_product.title }}\n        </button>\n        <button\n          class=\"col-6 col-md-2 btn btn-outline-secondary fs-7\n          border-start-0 d-md-none\"\n          type=\"button\"\n          @click=\"goToProduct(next_product)\"\n        >{{ next_product.title }}<i class=\"material-icons fs-6\">east</i>\n        </button>\n        <button\n          class=\"col-6 col-md-2 btn btn-outline-secondary fs-7\n          d-none d-md-flex\"\n          type=\"button\"\n          @click=\"goToProduct(next_product)\"\n        >{{ next_product.title }}<i class=\"material-icons fs-6\">east</i>\n        </button>\n      </div>\n    </div>\n    <div class=\"product-info mt-4\">\n      <div class=\"container row g-0 mx-auto p-3 pe-md-0 py-md-0\">\n        <div class=\"col-md-6 p-3 px-md-0 py-md-5 lh-lg\">\n          <h2 class=\"fs-5 text-primary\">注意事項</h2>\n          <p class=\"mb-4\">\n          {{product.content}}\n          </p>\n        </div>\n        <div class=\"bg-notice col-6\">\n        <span\n          style=\"\n            background-image: url('https://images.unsplash.com/photo-1490481651871-ab68de25d43d?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1350&q=80');\n          \"\n        ></span>\n      </div>\n      </div>\n\n    </div>\n    <div class=\"container px-3\" v-show=\"filterDatas.length > 0\">\n      <FrontSwiper\n        :datas=\"filterDatas\"\n        :is-disabled=\"isDisabled\"\n        title=\"相關商品\"\n      />\n    </div>\n    <div\n      id=\"target\"\n      class=\"position-fixed vw-100 bottom-10\"\n    ></div>\n  </div>\n</template>\n\n<script>\nimport { apiAllProducts, apiGetProduct } from '@/scripts/api';\nimport FrontSwiper from '@/components/FrontSwiper.vue';\n\nexport default {\n  emits: ['page-loading', 'push-message', 'toggle-spinner', 'add-cart'],\n  props: ['isDisabled', 'datas'],\n  components: {\n    FrontSwiper,\n  },\n  data() {\n    return {\n      id: '',\n      category: '',\n      products: [],\n      product: {},\n      enterImage: '',\n      prev_product: {},\n      next_product: {},\n      filterDatas: [],\n      tempNum: {},\n      maxNum: 0,\n      firstImage: '',\n    };\n  },\n  methods: {\n    getProduct() {\n      apiGetProduct(this.id)\n        .then((res) => {\n          if (!res.data.success) {\n            this.$pushMessage(res);\n            this.$router.push('/error');\n          }\n          this.product = res.data.product;\n          this.product.qty = 1;\n          this.category = this.product.category;\n          const img = this.product.imagesUrl;\n          /* eslint-disable */\n          this.firstImage = this.product.imagesUrl[0];\n          this.enterImage = img;\n          document.title = `${this.product.title} - Nature`;\n          this.filterProducts();\n          this.getSiblingProduct(this.products);\n          this.getMaxNum();\n          setTimeout(() => {\n            this.$emitter.emit('page-loading', false);\n          }, 1000);\n        })\n        .catch((err) => {\n          this.$emitter.emit('page-loading', false);\n          this.$pushMessage(err);\n        });\n    },\n    getAllProducts() {\n      apiAllProducts()\n        .then((res) => {\n          if (!res.data.success) {\n            this.$pushMessage(res);\n          }\n          this.products = res.data.products.reverse();\n          this.getProduct();\n        })\n        .catch((err) => {\n          this.$emitter.emit('page-loading', false);\n          this.$pushMessage(err);\n        });\n    },\n    // 取得同類別隨機商品\n    filterProducts() {\n      const { category, id } = this.product;\n      const arrFilter = this.products.filter(\n        (item) => item.category === category && item.id !== id,\n      );\n      const maxSize = arrFilter.length < 6 ? arrFilter.length : 6;\n      const arrSet = new Set([]);\n      for (let i = 0; arrSet.size < maxSize; i + 1) {\n        const num = Math.floor(Math.random() * arrFilter.length);\n        arrSet.add(num);\n      }\n      this.filterDatas = [];\n      arrSet.forEach((i) => {\n        this.filterDatas.push(arrFilter[i]);\n      });\n    },\n    // 取得前後一筆商品\n    getSiblingProduct(datas) {\n      datas.forEach((item, idx) => {\n        const { id } = item;\n        if (id === this.id) {\n          const prev = datas[idx - 1] || datas[datas.length - 1];\n          const next = datas[idx + 1] || datas[0];\n          this.prev_product = prev ? { id: prev.id, title: prev.title } : false;\n          this.next_product = next ? { id: next.id, title: next.title } : false;\n        }\n      });\n    },\n    // 取得可購買數量最大值\n    getMaxNum() {\n      const inCart = this.datas.carts.filter(\n        (item) => this.product.id === item.product_id,\n      );\n      if (!inCart) {\n        this.maxNum = 30;\n        return;\n      }\n      if (inCart.length > 0) {\n        this.maxNum = 30 - inCart[0].qty;\n      } else {\n        this.maxNum = 30;\n      }\n      if (this.maxNum <= 0) {\n        this.product.is_max = true;\n      } else {\n        this.product.is_max = false;\n      }\n    },\n    blurInput() {\n      this.product = this.tempNum;\n      if (this.tempNum.qty < 1) {\n        this.product.qty = 1;\n      }\n      this.tempNum = {};\n    },\n    addToCart(item) {\n      this.$emitter.emit('add-cart', { item, qty: item.qty });\n      this.$emitter.emit('toggle-spinner', { id: item.id });\n    },\n    goToProduct(item) {\n      if (!item.id) {\n        return;\n      }\n      this.$router.push(`./${item.id}`);\n    },\n  },\n  watch: {\n    $route: {\n      handler(val) {\n        if (val.name === 'Product') {\n          this.$emitter.emit('page-loading', true);\n          this.id = this.$route.params.id;\n          this.getProduct();\n        }\n      },\n      deep: true,\n    },\n    tempNum: {\n      handler(val) {\n        const { qty } = val;\n        const newItem = val;\n        if (qty >= this.maxNum) {\n          newItem.qty = this.maxNum;\n        }\n        if (qty < 1) {\n          newItem.qty = '';\n        }\n      },\n      deep: true,\n    },\n    datas() {\n      this.getProduct();\n    },\n  },\n  mounted() {\n    this.$emitter.emit('page-loading', true);\n    this.id = this.$route.params.id;\n    this.getAllProducts();\n  },\n};\n</script>\n","import { render } from \"./Product.vue?vue&type=template&id=0d97c157\"\nimport script from \"./Product.vue?vue&type=script&lang=js\"\nexport * from \"./Product.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\github\\\\Nature_store_lastest\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}